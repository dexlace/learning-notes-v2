# 动态代理  
## 一、什么是代理  
大道理上讲代理是一种软件设计模式，目的地希望能<font color=red>做到代码重用</font>。具体上讲，代理这种设计模式是<font color=red>通过不直接访问被代理对象的方式，而访问被代理对象的方法</font>。这个就好比商户---->明星经纪人(代理)---->明星这种模式。我们可以不通过直接与明星对话的情况下，而通过明星经纪人(代理)与其产生间接对话。  
在业务中使用动态代理，一般是为了给需要实现的方法<font color=red>添加预处理或者添加后续操作</font>，但是<font color=blue>不干预实现类的正常业务，把一些基本业务和主要的业务逻辑分离</font>。我们一般所熟知的<font color=red>Spring的AOP原理就是基于动态代理实现的</font>。  
![](_v_images/20190614223119669_28167.png =733x)  
## 二、静态代理和动态代理  
我们根据加载被代理类的时机不同，将代理分为静态代理和动态代理。如果我们在<font color=red>代码编译时</font>就确定了被代理的类是哪一个，那么就可以直接使用静态代理；如果不能确定，那么可以使用类的动态加载机制，在<font color=blue>代码运行期间加载被代理的类这就是动态代理</font>，比如RPC框架和Spring AOP机制。  
## 三、静态代理的实现  
### 3.1 创建一个接口  
![](_v_images/20190614223702537_30338.png =532x)  
### 3.2 创建一个目标类实现该接口  
![](_v_images/20190614223811467_16349.png =587x)  
### 3.3 创建一个代理类实现该接口  
![](_v_images/20190614224351179_20001.png =629x)  
![](_v_images/20190614224431820_5742.png =616x)  
  
<font size=4>结果</font>  
  
![](_v_images/20190614225021648_11338.png =411x)

  
<font size=4>很显然，就是静态代理就是<font color=red>实现同一接口</font>和<font color=blue>利用了多态的性质</font>，<font color=red>不同接口实现中的调用与被调用关系实现代码的增强</font></font>。  
  
<font size=4>我更愿意称<font color=red>双胞胎代理</font>。</font>  
  
## 四、动态代理  
### 4.1 目标类的接口  
![](_v_images/20190614231725734_23862.png =358x)  
### 4.2 目标类的实现  
![](_v_images/20190614231800792_5816.png =487x)  
### 4.3 目标类实现InvocationHandler接口  
![](_v_images/20190614232101762_22869.png =695x)  
### 4.4 利用反射技术实现目标类方法的增强  
![](_v_images/20190614233122017_2711.png =933x)  
  