# 运维笔记

## 虚拟机安装的若干主题

### 0.1 虚拟机的网络的三种模式

1. **桥接模式（Bridge Mode）：** 在桥接模式下，虚拟机会被连接到宿主机所在的物理网络中，就像是==网络中的一个独立节点一样==。虚拟机会获得一个与物理网络相同的 IP 地址范围，并且可以==直接与物理网络上的其他设备通信==。
2. **NAT 模式（Network Address Translation Mode）：** 在 NAT 模式下，虚拟机的网络连接==会通过宿主机的网络连接进行转换和代理==。虚拟机可以访问外部网络，但是==外部网络无法直接访问虚拟机==。它们通过==宿主机的 IP 地址进行通信，宿主机负责将数据包转发给正确的虚拟机==。
3. **主机模式（Host-Only Mode）：** 在主机模式下，==虚拟机可以与宿主机进行通信==，但是==无法直接访问外部网络==。这种模式通常用于搭建私有网络，例如用于开发和测试环境，虚拟机之间可以相互通信，但是不能与外部网络通信。

桥接模式和NAT模式是两种常见的虚拟机网络模式，它们之间有几个主要区别：

1. **IP 地址分配方式：**
   - **桥接模式：** 在桥接模式下，虚拟机会获得与物理网络相同的 IP 地址范围，并且可以直接与物理网络上的其他设备通信。虚拟机被视为网络中的独立节点。
   - **NAT 模式：** 在 NAT 模式下，虚拟机的网络连接会通过宿主机的网络连接进行转换和代理。虚拟机通过宿主机的 IP 地址访问外部网络，但是外部网络无法直接访问虚拟机。
2. **网络隔离程度：**
   - **桥接模式：** 在桥接模式下，虚拟机与物理网络中的其他设备处于相同的网络中，因此它们可以相互通信并与外部网络进行通信。虚拟机和物理网络之间没有明显的隔离。
   - **NAT 模式：** 在 NAT 模式下，虚拟机可以访问外部网络，但是外部网络无法直接访问虚拟机。虚拟机与外部网络之间有一定的隔离，外部网络只能通过宿主机的 IP 地址与虚拟机通信。
3. **网络配置复杂性：**
   - **桥接模式：** 在桥接模式下，虚拟机与物理网络中的其他设备具有相同的网络配置，因此虚拟机可以直接与物理网络中的其他设备通信。但是需要确保虚拟机的网络配置不会与物理网络中的其他设备冲突。
   - **NAT 模式：** 在 NAT 模式下，虚拟机的网络连接通过宿主机进行转换和代理，相对来说配置更加简单，但是需要注意宿主机的网络配置以及 NAT 转换可能带来的性能损耗。

选择桥接模式还是 NAT 模式取决于你的具体需求和网络环境。

### 0.2 主机复制到虚拟机

`scp /path/to/local/file username@remote_host:/path/to/destination`

## 一、linux基础

### 1、文件管理

#### 1.1 常见目录

- /bin：binary，存放二进制可执行文件
- /boot：系统启动目录
- /dev：驱动，设备文件
- /etc：==配置文件==
- /home：用户文件根目录
- /root：超级用户（系统管理员）的主目录

#### 1.2 目录处理

#### 1.3 文件查看

##### 1.3.1 cat

```bash
cat  ["选项"]	  ["文件名"]
# 

# 1、查看文本内容并显示行号:
cat -n file_name

# 2、将文本内容追加到其他文本中:
cat file_name >> file_name


# 3、将文本内容添加行号输出一个新文件中:
cat -n file_name > new_file_name

# 4、将文本内容清空，比如清空日志但是还要保留原文件:
cat /dev/null > log_file

# 5、合并文本内容：
cat file_name1 file_name2 file_name3 > file_name4
```

##### 1.3.2 more

```bash
more 是一个基于VI编辑器的文本过滤器，会以全屏幕的方式按页显示文本文件的内容
more [选项] 要查看的文件
more +3 log1.txt  # 显示文件中从第3行起的内容
more -12 /var/log/syslog # 每页限制显示12行  在按下空格键后，就会翻页显示后面的12行
more -s doc_30.txt  # 使用参数-s来忽略多余的空白行

# 通过参数+/string可以用来搜索字符串，找到的关键字会显示在***行。
more +/dhclient /var/log/syslog
# 如果要在文件中继续搜索下一个，只需要按下/按钮，后面跟有关键字dhclient
```

##### 1.3.3 less

```bash
less [参数]  文件 
# less 与 more 类似，但使用 less 可以随意浏览文件，而且 less 在查看之前不会加载整个文件。显示方面，显示内容方式不是输出到窗口，而是类似vi打开的文件一样，退出按q。
```

##### 1.3.4 tail

```bash
tail 用于输出文件中尾部的内容，默认情况下 tail 指令显示文件的后 10 行内容
tail 文件  # 查看文件后10行
tail -n 5 文件 # 查看文件后5行
tail -f 文件 # 持续输出文件尾部内容（一般用于日志文件） 
tail file1 file2: # 打印多个文件的后10行
```

### 2、用户管理

### 3、进程管理

进程是可执行的程序的运行实例

- 一个文件
- 被分配内存的地址空间
- 有权限控制
- 有一个或多个线程
- 有状态

#### 3.1 查看进程

```bash
ps -aux
# ps -a   显示当前终端的所有进程信息
# ps -u   以用户的格式显示进程的信息
# ps -x   显示后台进程运行的参数
ps -aux | grep xxx # 查看是否有xxx服务
ps -ef # 查看所有进程的父进程
# -e 显示所有进程  -f 全格式
# PID:进程ID
# PPID：父进程ID
# C：CPU用于计算执行优先级的因子，数值越大，表明进程是CPU密集型运算，执行优先级越低，数值越小，表示为I/O密集型，执行优先级越高
ps -ef | grep xxx # 查看xxx进程的父进程
```

![image-20221224171700571](/Users/dexlace/private-github-repository/learning-notes/运维/运维笔记.assets/image-20221224171700571.png)

#### 3.2 终止进程

``` bash
kill [信号] PID
# 信号是可选的 默认的结束方式是正常结束进程 
kill -9 pid
kill -SIGKILL pid
kill -KILL pid # 以上三种都是一个意思  强制结束某个进程
```

| 信号编号 | 信号名 | 含义                                                         |
| -------- | ------ | ------------------------------------------------------------ |
| 0        | EXIT   | 程序退出时收到该消息                                         |
| 1        | HUP    | 挂掉电话线或终端连接的挂起信号，这个信号也会造成某些进程在没有终止的情况下==重新初始化==。 |
| 2        | INT    | 表示结束进程，但并不是强制性的，常用的 "Ctrl+C" 组合键发出就是一个 kill -2 的信号。 |
| 3        | QUIT   | 退出。                                                       |
| 9        | KILL   | 杀死进程，即==强制结束进程==。                               |
| 11       | SEGV   | 段错误。                                                     |
| 15       | TERM   | 正常结束进程，是 kill 命令的默认信号。                       |

```bash
# 如果不知道某个进程的pid是多少，或者该进程有多个子进程，又想一次性杀死子进程和父进程，可以使用killall命令
killall [signal] <process-name>
```

#### 3.3 pstree

### 4、重定向和管道

文件描述符：FD,访问文件的标识，即链接文件。省去了冗长的绝对路径

- 0 键盘只读，一般是程序的输入
- 1,2是终端，一般是屏幕，1代表stdout，2代表stderr，即错误输出
- 3+是文件，可读可写

#### 4.1 输出重定向

```bash
# 覆盖输出重定向
命令  [1-n] > 文件或者文件操作符或设备
cat file1.txt 1>file2.txt  # 将本来要输出到屏幕的输出到file2.txt 其中1可以省略，只有1可以省略
cat file1.txt >file2.txt
# 注意以上的操作是清除文件原有内容再写入的
```

```bash
# 追加重定向
命令  [1-n] >> 文件或文件操作符或设备
cat file1.txt 1>>file2.txt  # 将本来要输出到屏幕的输出到file2.txt 其中1可以省略，只有1可以省略
cat file1.txt >>file2.txt
# 注意以上的操作是清除文件原有内容再写入的
ls ./ 2>>file3.txt
date >>date.txt
```

```bash
# “&>”也用作输出重定向，使用格式：
# 命令 &> 文件
# 作用：&>不同于>，它既能把正确的信息输出重定向到文件，又能把错 误的信息输出重定向到文件
ls /home/ /aaaaaaaaa >list.txt 2>error.txt # 重定向到不同的位置
ls /home/ /aaaaaaaaa &>list.txt # 混合输出
ls /home/ /aaaaaaaaa >list.txt 2>&1 # 重定向到相同的位置
ls /home/ /aaaaaaaaa >list.txt 2>/dev/null # 空设备，即将产生的错误输出丢掉
ls /home/ /aaaaaaaaa &>/dev/null # 空设备，即将产生的输出丢掉
```

#### 4.2 输入重定向

略

#### 4.3 管道

略

### 5、磁盘管理

磁盘命名方式

IDE、SATA接口

分区方式：

- MBR：支持最大的磁盘容量<2TB
- GPT

磁盘管理三部曲：分区、格式化、挂载

==磁盘查看==

- ```bash
  ll /dev/sd* # RHEL8之前
  ll /dev/nvme* # RHEL8及之后
  ```

- ```bash
  lsblk 
  ```

==创建分区==



### 6、软件安装

更换yum源

```bash
mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.bak  # 先备份
wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repo # -O  --output-document=文件，将数据写入此文件中。

# 所以以上关键是创建一个好的yum源
yum clean all
yum makecache
```



### 7、任务计划

### 8、日志管理

### 9、网络管理

